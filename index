#!/bin/sh

test ! -z "$HTTP_PARAM_t" || HTTP_PARAM_t=0

flags="-c"
if test -z "$HTTP_PARAM_b"; then
	buttons="$buttons`QB ğŸ…±ï¸ b 1`"
else
	flags="$flags -b"
	buttons="$buttons`QB "#ï¸âƒ£" b`"
fi

test -z "$HTTP_PARAM_r" || flags="$flags -B"

if test -z "$HTTP_PARAM_l"; then
	buttons="$buttons`QB ğŸ›ï¸ l 1`"
else
	flags="$flags -l"
	buttons="$buttons`QB ğŸ”  l`"
fi

_TITLE="`cat data.txt | head -n 1`"

buttons="$buttons`echo "<input name='t' type='number' step='1' value='$HTTP_PARAM_t'></input>" | FB "ğŸšï¸" "" "GET" "t"`"

if is_main; then
	im $OWNER || buttons="$buttons`IFB "ğŸ”±" "$DOCUMENT_URI/fork"`"
else
	buttons="$buttons`RB "ğŸ”" "$DOCUMENT_URI/diff"`"
	im $ORIG_OWNER && buttons="$buttons`IFB "ğŸŸ£" "$DOCUMENT_URI/merge"`"
fi

echo "$buttons" >> $DOCUMENT_ROOT/tmp/fun
yt="`zcat yt`"
test -z "$yt" || \
	printf "\n<iframe src='https://www.youtube.com/embed/$yt' frameborder='0'></iframe>"

cat - <<!
<pre class='v0 chords'>
`cat data.txt | tail -n +3 | transp -t $HTTP_PARAM_t -h $flags`
</pre>
<b>`_ Types`</b>
<pre>
`cat type`
</pre>
!
